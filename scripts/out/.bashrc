#!/usr/bin/bash

### do not edit this file 
### it was generated via the /home/raf/proj/unix-stuff/scripts/init script


### ././bash/rc.bash

# If not running interactively, don't do anything
[[ $- != *i* ]] && return
### eo ././bash/rc.bash

### ././bash/history.bash

HISTSIZE=100000
HISTFILESIZE=200000
HISTCONTROL=ignoredups:ignorespace
HISTIGNORE="&:[ ]*:exit"

### eo ././bash/history.bash

### ././bash/ps1.bash

# PS1='[\u@\h \W]\$ '

function set_prompt_colors() {
  local color
  local reset="\[\e[0m\]"

  local status

  status="$(git status --porcelain -b 2>/dev/null)"

  if [ ! "$status" ]; then
    color="\[\e[1;96m\]" 
    PS1="${color}\u@\w\$${reset} "
    return
  fi

  case "$status" in
  *"behind"* | *"no branch"*)
    color="\[\e[1;41m\]" # red
    ;;
  *"ahead"* | *"M "* | *"A "* | *"?? "* | *"No commits yet on "*)
    color="\[\e[1;33m\]" # yellow
    ;;
  *)
    color="\[\e[1;32m\]" # green
    ;;
  esac
  local last_commit_msg="$(git log -i --pretty=%B | head -n 1)"

  PS1="\u@\h${color}[\w]${reset} "${last_commit_msg}"\n\$ "
}

PROMPT_COMMAND="set_prompt_colors"
### eo ././bash/ps1.bash

### ././bash/aliases.bash

alias cat="bat"
alias dmesg="sudo dmesg"
alias l="ls -lhA "
alias ls="command ls --color=auto "
alias reboot="sudo reboot"
alias shutdown="sudo shutdown -h now"
alias updatedb="sudo updatedb"
alias vi="nvim"
alias x="startx"
alias rc="nvim ~/.bashrc; source ~/.bashrc"
alias rmf="rm -rf "
### eo ././bash/aliases.bash

### ././bash/sudo.bash

function sudo() {
  # replace vi for nvim for convenience, otherwise executes sudo as usual
  if [[ $1 == 'vi' ]]; then
    command sudo nvim "${@:2}"
  else
    command sudo "$@"
  fi
}
### eo ././bash/sudo.bash

### ././bash/xbps.bash

alias inst="sudo xbps-install --sync --yes "
alias update="sudo xbps-install --sync --update "
alias remove="sudo xbps-remove --clean-cache --remove-orphans "
alias search="xbps-query --regex --repository --search "

pkg-update() {
  dir=$(pwd)
  pkg="${1:-google-chrome}"
  cd ~/void-packages || exit
  git pull
  ./xbps-src pkg "$pkg"
  sudo xbps-install --repository hostdir/binpkgs/nonfree "$pkg"
  cd "$dir" || exit
}
### eo ././bash/xbps.bash

### ././bash/runit.bash

svs() { sudo ln -s "$1" /var/service; }
### eo ././bash/runit.bash

### ././bash/git.bash

alias L="git log"
alias M="git commit --amend"
alias Ss="git status "
alias S="git status --porcelain -b "
alias A="git add -A"

function C() { git commit -m "$*"; }

function github-login() {
  local name email filename

  if [ "$#" -lt 3 ]; then
    echo "Usage: github-login <first name> <last name> <email>"
    return 1
  fi

  name="$1 $2"
  email="$3"
  filename="$(ls "$HOME"/.ssh/id_*_"${3%%@*}" 2>/dev/null)"
  if [ ! -e "$filename" ]; then
    echo "Error: Unknown user: ${name} email: ${email}"
    return 1
  fi

  eval "$(ssh-agent -s)"
  ssh-add "${filename}"

  git config --global user.name \""$name"\"
  git config --global user.email \""$email"\"
}
### eo ././bash/git.bash

### ././bash/webdev.bash

alias nrd="npm run dev"
alias nrs="npm run serve"
### eo ././bash/webdev.bash

### ././bash/qmk.bash

qmk-flash() { qmk flash -kb raferris -km default -bl avrdude; }
### eo ././bash/qmk.bash

